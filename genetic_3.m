clear
clc
close all
load 'demanda_1.mat' matriz
rng default % For reproducibility
%% 3 sectores
nsec = 3;
naero = length(matriz);
carga = ceil(naero/nsec);
%% Declaracion de las restricciones lineales y cotas de variables
% Restriccion lineal desigualdad x(3) <= 
A = zeros(3,66);
A(1,1:22) = ones;
A(2,23:44) = ones;
A(3,45:66) = ones;
b=[carga carga carga];
% Restricciones de igualdad
Aeq=[eye(22) eye(22) eye(22)];
beq = ones(22,1);
% Cotas
lb=zeros(1,66); % inferior x(i) >= 0
ub=ones(1,66); % superior
intcon=(1:66); % integer variables
nonlcon = [];
%% Handler de funcion y restricciones
fun=@f_obj;
[x,fval] = ga(fun,66,A,b,Aeq,beq,lb,ub,nonlcon,intcon);

Xcg1=(1/(x(1)+x(2)+x(3)+x(4)+x(5)+x(6)+x(7)+x(8)+x(9)+x(10)+x(11)+x(12)+x(13)+x(14)+x(15)+x(16)+x(17)+x(18)+x(19)+x(20)+x(21)+x(22)))*...
(matriz(1,2)*x(1)+...
matriz(2,2)*x(2)+...
matriz(3,2)*x(3)+...
matriz(4,2)*x(4)+...
matriz(5,2)*x(5)+...
matriz(6,2)*x(6)+...
matriz(7,2)*x(7)+...
matriz(8,2)*x(8)+...
matriz(9,2)*x(9)+...
matriz(10,2)*x(10)+...
matriz(11,2)*x(11)+...
matriz(12,2)*x(12)+...
matriz(13,2)*x(13)+...
matriz(14,2)*x(14)+...
matriz(15,2)*x(15)+...
matriz(16,2)*x(16)+...
matriz(17,2)*x(17)+...
matriz(18,2)*x(18)+...
matriz(19,2)*x(19)+...
matriz(20,2)*x(20)+...
matriz(21,2)*x(21)+...
matriz(22,2)*x(22));

Xcg2=(1/(x(23)+x(24)+x(25)+x(26)+x(27)+x(28)+x(29)+x(30)+x(31)+x(32)+x(33)+x(34)+x(35)+x(36)+x(37)+x(38)+x(39)+x(40)+x(41)+x(42)+x(43)+x(44)))*...
(matriz(1,2)*x(23)+...
matriz(2,2)*x(24)+...
matriz(3,2)*x(25)+...
matriz(4,2)*x(26)+...
matriz(5,2)*x(27)+...
matriz(6,2)*x(28)+...
matriz(7,2)*x(29)+...
matriz(8,2)*x(30)+...
matriz(9,2)*x(31)+...
matriz(10,2)*x(32)+...
matriz(11,2)*x(33)+...
matriz(12,2)*x(34)+...
matriz(13,2)*x(35)+...
matriz(14,2)*x(36)+...
matriz(15,2)*x(37)+...
matriz(16,2)*x(38)+...
matriz(17,2)*x(39)+...
matriz(18,2)*x(40)+...
matriz(19,2)*x(41)+...
matriz(20,2)*x(42)+...
matriz(21,2)*x(43)+...
matriz(22,2)*x(44));

Xcg3=(1/(x(45)+x(46)+x(47)+x(48)+x(49)+x(50)+x(51)+x(52)+x(53)+x(54)+x(55)+x(56)+x(57)+x(58)+x(59)+x(60)+x(61)+x(62)+x(63)+x(64)+x(65)+x(66)))*...
(matriz(1,2)*x(45)+...
matriz(2,2)*x(46)+...
matriz(3,2)*x(47)+...
matriz(4,2)*x(48)+...
matriz(5,2)*x(49)+...
matriz(6,2)*x(50)+...
matriz(7,2)*x(51)+...
matriz(8,2)*x(52)+...
matriz(9,2)*x(53)+...
matriz(10,2)*x(54)+...
matriz(11,2)*x(55)+...
matriz(12,2)*x(56)+...
matriz(13,2)*x(57)+...
matriz(14,2)*x(58)+...
matriz(15,2)*x(59)+...
matriz(16,2)*x(60)+...
matriz(17,2)*x(61)+...
matriz(18,2)*x(62)+...
matriz(19,2)*x(63)+...
matriz(20,2)*x(64)+...
matriz(21,2)*x(65)+...
matriz(22,2)*x(66));

Ycg1=(1/(x(1)+x(2)+x(3)+x(4)+x(5)+x(6)+x(7)+x(8)+x(9)+x(10)+x(11)+x(12)+x(13)+x(14)+x(15)+x(16)+x(17)+x(18)+x(19)+x(20)+x(21)+x(22)))*...
(matriz(1,3)*x(1)+...
matriz(2,3)*x(2)+...
matriz(3,3)*x(3)+...
matriz(4,3)*x(4)+...
matriz(5,3)*x(5)+...
matriz(6,3)*x(6)+...
matriz(7,3)*x(7)+...
matriz(8,3)*x(8)+...
matriz(9,3)*x(9)+...
matriz(10,3)*x(10)+...
matriz(11,3)*x(11)+...
matriz(12,3)*x(12)+...
matriz(13,3)*x(13)+...
matriz(14,3)*x(14)+...
matriz(15,3)*x(15)+...
matriz(16,3)*x(16)+...
matriz(17,3)*x(17)+...
matriz(18,3)*x(18)+...
matriz(19,3)*x(19)+...
matriz(20,3)*x(20)+...
matriz(21,3)*x(21)+...
matriz(22,3)*x(22));

Ycg2=(1/(x(23)+x(24)+x(25)+x(26)+x(27)+x(28)+x(29)+x(30)+x(31)+x(32)+x(33)+x(34)+x(35)+x(36)+x(37)+x(38)+x(39)+x(40)+x(41)+x(42)+x(43)+x(44)))*...
(matriz(1,3)*x(23)+...
matriz(2,3)*x(24)+...
matriz(3,3)*x(25)+...
matriz(4,3)*x(26)+...
matriz(5,3)*x(27)+...
matriz(6,3)*x(28)+...
matriz(7,3)*x(29)+...
matriz(8,3)*x(30)+...
matriz(9,3)*x(31)+...
matriz(10,3)*x(32)+...
matriz(11,3)*x(33)+...
matriz(12,3)*x(34)+...
matriz(13,3)*x(35)+...
matriz(14,3)*x(36)+...
matriz(15,3)*x(37)+...
matriz(16,3)*x(38)+...
matriz(17,3)*x(39)+...
matriz(18,3)*x(40)+...
matriz(19,3)*x(41)+...
matriz(20,3)*x(42)+...
matriz(21,3)*x(43)+...
matriz(22,3)*x(44));

Ycg3=(1/(x(45)+x(46)+x(47)+x(48)+x(49)+x(50)+x(51)+x(52)+x(53)+x(54)+x(55)+x(56)+x(57)+x(58)+x(59)+x(60)+x(61)+x(62)+x(63)+x(64)+x(65)+x(66)))*...
(matriz(1,3)*x(45)+...
matriz(2,3)*x(46)+...
matriz(3,3)*x(47)+...
matriz(4,3)*x(48)+...
matriz(5,3)*x(49)+...
matriz(6,3)*x(50)+...
matriz(7,3)*x(51)+...
matriz(8,3)*x(52)+...
matriz(9,3)*x(53)+...
matriz(10,3)*x(54)+...
matriz(11,3)*x(55)+...
matriz(12,3)*x(56)+...
matriz(13,3)*x(57)+...
matriz(14,3)*x(58)+...
matriz(15,3)*x(59)+...
matriz(16,3)*x(60)+...
matriz(17,3)*x(61)+...
matriz(18,3)*x(62)+...
matriz(19,3)*x(63)+...
matriz(20,3)*x(64)+...
matriz(21,3)*x(65)+...
matriz(22,3)*x(66));

matrizXcg=[Xcg1; Xcg2; Xcg3];
matrizYcg=[Ycg1; Ycg2; Ycg3];

plot(matrizXcg,matrizYcg,'o')
hold on
plot(matriz(:,2),matriz(:,3),'d')
voronoi(matrizXcg,matrizYcg)
xlim([0 600]);
ylim([0 600]);

n1 = x(1)+x(2)+x(3)+x(4)+x(5)+x(6)+x(7)+x(8)+x(9)+x(10)+x(11)+x(12)+x(13)+x(14)+x(15)+x(16)+x(17)+x(18)+x(19)+x(20)+x(21)+x(22);
n2 = x(23)+x(24)+x(25)+x(26)+x(27)+x(28)+x(29)+x(30)+x(31)+x(32)+x(33)+x(34)+x(35)+x(36)+x(37)+x(38)+x(39)+x(40)+x(41)+x(42)+x(43)+x(44);
n3 = x(45)+x(46)+x(47)+x(48)+x(49)+x(50)+x(51)+x(52)+x(53)+x(54)+x(55)+x(56)+x(57)+x(58)+x(59)+x(60)+x(61)+x(62)+x(63)+x(64)+x(65)+x(66);
%% Comparaciones
% close all
% figure(2)
% load 'demanda_4.mat' matriz
% hold on
% plot(matriz(:,2),matriz(:,3),'d')
% voronoi(matrizXcg,matrizYcg)
% xlim([0 600]);
% ylim([0 600]);
%% Declaración de la funcion
function fun = f_obj(x)
    load 'demanda_1.mat' matriz;

    Xcg1=(1/(x(1)+x(2)+x(3)+x(4)+x(5)+x(6)+x(7)+x(8)+x(9)+x(10)+x(11)+x(12)+x(13)+x(14)+x(15)+x(16)+x(17)+x(18)+x(19)+x(20)+x(21)+x(22)))*...
    (matriz(1,2)*x(1)+...
    matriz(2,2)*x(2)+...
    matriz(3,2)*x(3)+...
    matriz(4,2)*x(4)+...
    matriz(5,2)*x(5)+...
    matriz(6,2)*x(6)+...
    matriz(7,2)*x(7)+...
    matriz(8,2)*x(8)+...
    matriz(9,2)*x(9)+...
    matriz(10,2)*x(10)+...
    matriz(11,2)*x(11)+...
    matriz(12,2)*x(12)+...
    matriz(13,2)*x(13)+...
    matriz(14,2)*x(14)+...
    matriz(15,2)*x(15)+...
    matriz(16,2)*x(16)+...
    matriz(17,2)*x(17)+...
    matriz(18,2)*x(18)+...
    matriz(19,2)*x(19)+...
    matriz(20,2)*x(20)+...
    matriz(21,2)*x(21)+...
    matriz(22,2)*x(22));

    Xcg2=(1/(x(23)+x(24)+x(25)+x(26)+x(27)+x(28)+x(29)+x(30)+x(31)+x(32)+x(33)+x(34)+x(35)+x(36)+x(37)+x(38)+x(39)+x(40)+x(41)+x(42)+x(43)+x(44)))*...
    (matriz(1,2)*x(23)+...
    matriz(2,2)*x(24)+...
    matriz(3,2)*x(25)+...
    matriz(4,2)*x(26)+...
    matriz(5,2)*x(27)+...
    matriz(6,2)*x(28)+...
    matriz(7,2)*x(29)+...
    matriz(8,2)*x(30)+...
    matriz(9,2)*x(31)+...
    matriz(10,2)*x(32)+...
    matriz(11,2)*x(33)+...
    matriz(12,2)*x(34)+...
    matriz(13,2)*x(35)+...
    matriz(14,2)*x(36)+...
    matriz(15,2)*x(37)+...
    matriz(16,2)*x(38)+...
    matriz(17,2)*x(39)+...
    matriz(18,2)*x(40)+...
    matriz(19,2)*x(41)+...
    matriz(20,2)*x(42)+...
    matriz(21,2)*x(43)+...
    matriz(22,2)*x(44));

    Xcg3=(1/(x(45)+x(46)+x(47)+x(48)+x(49)+x(50)+x(51)+x(52)+x(53)+x(54)+x(55)+x(56)+x(57)+x(58)+x(59)+x(60)+x(61)+x(62)+x(63)+x(64)+x(65)+x(66)))*...
    (matriz(1,2)*x(45)+...
    matriz(2,2)*x(46)+...
    matriz(3,2)*x(47)+...
    matriz(4,2)*x(48)+...
    matriz(5,2)*x(49)+...
    matriz(6,2)*x(50)+...
    matriz(7,2)*x(51)+...
    matriz(8,2)*x(52)+...
    matriz(9,2)*x(53)+...
    matriz(10,2)*x(54)+...
    matriz(11,2)*x(55)+...
    matriz(12,2)*x(56)+...
    matriz(13,2)*x(57)+...
    matriz(14,2)*x(58)+...
    matriz(15,2)*x(59)+...
    matriz(16,2)*x(60)+...
    matriz(17,2)*x(61)+...
    matriz(18,2)*x(62)+...
    matriz(19,2)*x(63)+...
    matriz(20,2)*x(64)+...
    matriz(21,2)*x(65)+...
    matriz(22,2)*x(66));

    Ycg1=(1/(x(1)+x(2)+x(3)+x(4)+x(5)+x(6)+x(7)+x(8)+x(9)+x(10)+x(11)+x(12)+x(13)+x(14)+x(15)+x(16)+x(17)+x(18)+x(19)+x(20)+x(21)+x(22)))*...
    (matriz(1,3)*x(1)+...
    matriz(2,3)*x(2)+...
    matriz(3,3)*x(3)+...
    matriz(4,3)*x(4)+...
    matriz(5,3)*x(5)+...
    matriz(6,3)*x(6)+...
    matriz(7,3)*x(7)+...
    matriz(8,3)*x(8)+...
    matriz(9,3)*x(9)+...
    matriz(10,3)*x(10)+...
    matriz(11,3)*x(11)+...
    matriz(12,3)*x(12)+...
    matriz(13,3)*x(13)+...
    matriz(14,3)*x(14)+...
    matriz(15,3)*x(15)+...
    matriz(16,3)*x(16)+...
    matriz(17,3)*x(17)+...
    matriz(18,3)*x(18)+...
    matriz(19,3)*x(19)+...
    matriz(20,3)*x(20)+...
    matriz(21,3)*x(21)+...
    matriz(22,3)*x(22));

    Ycg2=(1/(x(23)+x(24)+x(25)+x(26)+x(27)+x(28)+x(29)+x(30)+x(31)+x(32)+x(33)+x(34)+x(35)+x(36)+x(37)+x(38)+x(39)+x(40)+x(41)+x(42)+x(43)+x(44)))*...
    (matriz(1,3)*x(23)+...
    matriz(2,3)*x(24)+...
    matriz(3,3)*x(25)+...
    matriz(4,3)*x(26)+...
    matriz(5,3)*x(27)+...
    matriz(6,3)*x(28)+...
    matriz(7,3)*x(29)+...
    matriz(8,3)*x(30)+...
    matriz(9,3)*x(31)+...
    matriz(10,3)*x(32)+...
    matriz(11,3)*x(33)+...
    matriz(12,3)*x(34)+...
    matriz(13,3)*x(35)+...
    matriz(14,3)*x(36)+...
    matriz(15,3)*x(37)+...
    matriz(16,3)*x(38)+...
    matriz(17,3)*x(39)+...
    matriz(18,3)*x(40)+...
    matriz(19,3)*x(41)+...
    matriz(20,3)*x(42)+...
    matriz(21,3)*x(43)+...
    matriz(22,3)*x(44));

    Ycg3=(1/(x(45)+x(46)+x(47)+x(48)+x(49)+x(50)+x(51)+x(52)+x(53)+x(54)+x(55)+x(56)+x(57)+x(58)+x(59)+x(60)+x(61)+x(62)+x(63)+x(64)+x(65)+x(66)))*...
    (matriz(1,3)*x(45)+...
    matriz(2,3)*x(46)+...
    matriz(3,3)*x(47)+...
    matriz(4,3)*x(48)+...
    matriz(5,3)*x(49)+...
    matriz(6,3)*x(50)+...
    matriz(7,3)*x(51)+...
    matriz(8,3)*x(52)+...
    matriz(9,3)*x(53)+...
    matriz(10,3)*x(54)+...
    matriz(11,3)*x(55)+...
    matriz(12,3)*x(56)+...
    matriz(13,3)*x(57)+...
    matriz(14,3)*x(58)+...
    matriz(15,3)*x(59)+...
    matriz(16,3)*x(60)+...
    matriz(17,3)*x(61)+...
    matriz(18,3)*x(62)+...
    matriz(19,3)*x(63)+...
    matriz(20,3)*x(64)+...
    matriz(21,3)*x(65)+...
    matriz(22,3)*x(66));


    %término para x en sector 1
    p1=((Xcg1-matriz(1,2)*x(1))^2)*x(1)+...
    (Xcg1-matriz(2,2)*x(2))^2*x(2)+...
    (Xcg1-matriz(3,2)*x(3))^2*x(3)+...
    (Xcg1-matriz(4,2)*x(4))^2*x(4)+...
    (Xcg1-matriz(5,2)*x(5))^2*x(5)+...
    (Xcg1-matriz(6,2)*x(6))^2*x(6)+...
    (Xcg1-matriz(7,2)*x(7))^2*x(7)+...
    (Xcg1-matriz(8,2)*x(8))^2*x(8)+...
    (Xcg1-matriz(9,2)*x(9))^2*x(9)+...
    (Xcg1-matriz(10,2)*x(10))^2*x(10)+...
    (Xcg1-matriz(11,2)*x(11))^2*x(11)+...
    (Xcg1-matriz(12,2)*x(12))^2*x(12)+...
    (Xcg1-matriz(13,2)*x(13))^2*x(13)+...
    (Xcg1-matriz(14,2)*x(14))^2*x(14)+...
    (Xcg1-matriz(15,2)*x(15))^2*x(15)+...
    (Xcg1-matriz(16,2)*x(16))^2*x(16)+...
    (Xcg1-matriz(17,2)*x(17))^2*x(17)+...
    (Xcg1-matriz(18,2)*x(18))^2*x(18)+...
    (Xcg1-matriz(19,2)*x(19))^2*x(19)+...
    (Xcg1-matriz(20,2)*x(20))^2*x(20)+...
    (Xcg1-matriz(21,2)*x(21))^2*x(21)+...
    (Xcg1-matriz(22,2)*x(22))^2*x(22);
    
    %término para y en sector 1
    p2=(Ycg1-matriz(1,3)*x(1))^2*x(1)+...
    (Ycg1-matriz(2,3)*x(2))^2*x(2)+...
    (Ycg1-matriz(3,3)*x(3))^2*x(3)+...
    (Ycg1-matriz(4,3)*x(4))^2*x(4)+...
    (Ycg1-matriz(5,3)*x(5))^2*x(5)+...
    (Ycg1-matriz(6,3)*x(6))^2*x(6)+...
    (Ycg1-matriz(7,3)*x(7))^2*x(7)+...
    (Ycg1-matriz(8,3)*x(8))^2*x(8)+...
    (Ycg1-matriz(9,3)*x(9))^2*x(9)+...
    (Ycg1-matriz(10,3)*x(10))^2*x(10)+...
    (Ycg1-matriz(11,3)*x(11))^2*x(11)+...
    (Ycg1-matriz(12,3)*x(12))^2*x(12)+...
    (Ycg1-matriz(13,3)*x(13))^2*x(13)+...
    (Ycg1-matriz(14,3)*x(14))^2*x(14)+...
    (Ycg1-matriz(15,3)*x(15))^2*x(15)+...
    (Ycg1-matriz(16,3)*x(16))^2*x(16)+...
    (Ycg1-matriz(17,3)*x(17))^2*x(17)+...
    (Ycg1-matriz(18,3)*x(18))^2*x(18)+...
    (Ycg1-matriz(19,3)*x(19))^2*x(19)+...
    (Ycg1-matriz(20,3)*x(20))^2*x(20)+...
    (Ycg1-matriz(21,3)*x(21))^2*x(21)+...
    (Ycg1-matriz(22,3)*x(22))^2*x(22);

    %término para x en sector 2
    p3=(Xcg2-matriz(1,2)*x(23))^2*x(23)+...
    (Xcg2-matriz(2,2)*x(24))^2*x(24)+...
    (Xcg2-matriz(3,2)*x(25))^2*x(25)+...
    (Xcg2-matriz(4,2)*x(26))^2*x(26)+...
    (Xcg2-matriz(5,2)*x(27))^2*x(27)+...
    (Xcg2-matriz(6,2)*x(28))^2*x(28)+...
    (Xcg2-matriz(7,2)*x(29))^2*x(29)+...
    (Xcg2-matriz(8,2)*x(30))^2*x(30)+...
    (Xcg2-matriz(9,2)*x(31))^2*x(31)+...
    (Xcg2-matriz(10,2)*x(32))^2*x(32)+...
    (Xcg2-matriz(11,2)*x(33))^2*x(33)+...
    (Xcg2-matriz(12,2)*x(34))^2*x(34)+...
    (Xcg2-matriz(13,2)*x(35))^2*x(35)+...
    (Xcg2-matriz(14,2)*x(36))^2*x(36)+...
    (Xcg2-matriz(15,2)*x(37))^2*x(37)+...
    (Xcg2-matriz(16,2)*x(38))^2*x(38)+...
    (Xcg2-matriz(17,2)*x(39))^2*x(39)+...
    (Xcg2-matriz(18,2)*x(40))^2*x(40)+...
    (Xcg2-matriz(19,2)*x(41))^2*x(41)+...
    (Xcg2-matriz(20,2)*x(42))^2*x(42)+...
    (Xcg2-matriz(21,2)*x(43))^2*x(43)+...
    (Xcg2-matriz(22,2)*x(44))^2*x(44);

    %término para y en sector 2
    p4=(Ycg2-matriz(1,3)*x(23))^2*x(23)+...
    (Ycg2-matriz(2,3)*x(24))^2*x(24)+...
    (Ycg2-matriz(3,3)*x(25))^2*x(25)+...
    (Ycg2-matriz(4,3)*x(26))^2*x(26)+...
    (Ycg2-matriz(5,3)*x(27))^2*x(27)+...
    (Ycg2-matriz(6,3)*x(28))^2*x(28)+...
    (Ycg2-matriz(7,3)*x(29))^2*x(29)+...
    (Ycg2-matriz(8,3)*x(30))^2*x(30)+...
    (Ycg2-matriz(9,3)*x(31))^2*x(31)+...
    (Ycg2-matriz(10,3)*x(32))^2*x(32)+...
    (Ycg2-matriz(11,3)*x(33))^2*x(33)+...
    (Ycg2-matriz(12,3)*x(34))^2*x(34)+...
    (Ycg2-matriz(13,3)*x(35))^2*x(35)+...
    (Ycg2-matriz(14,3)*x(36))^2*x(36)+...
    (Ycg2-matriz(15,3)*x(37))^2*x(37)+...
    (Ycg2-matriz(16,3)*x(38))^2*x(38)+...
    (Ycg2-matriz(17,3)*x(39))^2*x(39)+...
    (Ycg2-matriz(18,3)*x(40))^2*x(40)+...
    (Ycg2-matriz(19,3)*x(41))^2*x(41)+...
    (Ycg2-matriz(20,3)*x(42))^2*x(42)+...
    (Ycg2-matriz(21,3)*x(43))^2*x(43)+...
    (Ycg2-matriz(22,3)*x(44))^2*x(44);

    %término para x en sector 3
    p5=(Xcg3-matriz(1,2)*x(45))^2*x(45)+...
    (Xcg3-matriz(2,2)*x(46))^2*x(46)+...
    (Xcg3-matriz(3,2)*x(47))^2*x(47)+...
    (Xcg3-matriz(4,2)*x(48))^2*x(48)+...
    (Xcg3-matriz(5,2)*x(49))^2*x(49)+...
    (Xcg3-matriz(6,2)*x(50))^2*x(50)+...
    (Xcg3-matriz(7,2)*x(51))^2*x(51)+...
    (Xcg3-matriz(8,2)*x(52))^2*x(52)+...
    (Xcg3-matriz(9,2)*x(53))^2*x(53)+...
    (Xcg3-matriz(10,2)*x(54))^2*x(54)+...
    (Xcg3-matriz(11,2)*x(55))^2*x(55)+...
    (Xcg3-matriz(12,2)*x(56))^2*x(56)+...
    (Xcg3-matriz(13,2)*x(57))^2*x(57)+...
    (Xcg3-matriz(14,2)*x(58))^2*x(58)+...
    (Xcg3-matriz(15,2)*x(59))^2*x(59)+...
    (Xcg3-matriz(16,2)*x(60))^2*x(60)+...
    (Xcg3-matriz(17,2)*x(61))^2*x(61)+...
    (Xcg3-matriz(18,2)*x(62))^2*x(62)+...
    (Xcg3-matriz(19,2)*x(63))^2*x(63)+...
    (Xcg3-matriz(20,2)*x(64))^2*x(64)+...
    (Xcg3-matriz(21,2)*x(65))^2*x(65)+...
    (Xcg3-matriz(22,2)*x(66))^2*x(66);

    %término para y en sector 3
    p6=(Ycg3-matriz(1,3)*x(45))^2*x(45)+...
    (Ycg3-matriz(2,3)*x(46))^2*x(46)+...
    (Ycg3-matriz(3,3)*x(47))^2*x(47)+...
    (Ycg3-matriz(4,3)*x(48))^2*x(48)+...
    (Ycg3-matriz(5,3)*x(49))^2*x(49)+...
    (Ycg3-matriz(6,3)*x(50))^2*x(50)+...
    (Ycg3-matriz(7,3)*x(51))^2*x(51)+...
    (Ycg3-matriz(8,3)*x(52))^2*x(52)+...
    (Ycg3-matriz(9,3)*x(53))^2*x(53)+...
    (Ycg3-matriz(10,3)*x(54))^2*x(54)+...
    (Ycg3-matriz(11,3)*x(55))^2*x(55)+...
    (Ycg3-matriz(12,3)*x(56))^2*x(56)+...
    (Ycg3-matriz(13,3)*x(57))^2*x(57)+...
    (Ycg3-matriz(14,3)*x(58))^2*x(58)+...
    (Ycg3-matriz(15,3)*x(59))^2*x(59)+...
    (Ycg3-matriz(16,3)*x(60))^2*x(60)+...
    (Ycg3-matriz(17,3)*x(61))^2*x(61)+...
    (Ycg3-matriz(18,3)*x(62))^2*x(62)+...
    (Ycg3-matriz(19,3)*x(63))^2*x(63)+...
    (Ycg3-matriz(20,3)*x(64))^2*x(64)+...
    (Ycg3-matriz(21,3)*x(65))^2*x(65)+...
    (Ycg3-matriz(22,3)*x(66))^2*x(66);

    %Función objetivo
    fun=p1+p2+p3+p4+p5+p6;
end


